import{j as e,r as o,H as k}from"./app-B2Z8cRq3.js";import{I as t}from"./Icon-DBwaLCyv.js";import{A as C}from"./AdminLayout-Dx2bDVLc.js";import _ from"./ClassDetailSidebar-DFuRqAPX.js";import I from"./EditClassModal-bpLQKa-1.js";import{f as h,E as S}from"./EditModuleModal-3jCJHWzv.js";import O from"./EditQuizModal-BfnNQqDj.js";import Q from"./PublishConfirmModal-BZQQedhT.js";import"./Avatar-DtCPdeWf.js";import"./ClassForm-CRJHl7Hs.js";import"./FormInput-C6L9VaUL.js";import"./FormSelect-CWaycFwg.js";import"./ImageUpload-CVtW8Qbi.js";import"./RichTextEditor-DHfOHHVU.js";import"./ModuleForm-C1iUBWPp.js";import"./QuizForm-s-9_CV7n.js";function q({totalModules:s,totalLessons:i,totalDuration:n}){return e.jsxs("div",{className:"flex w-full flex-row gap-4",children:[e.jsxs("div",{className:"flex flex-1 items-center justify-between rounded-xl border border-[#dae7e0] bg-white p-5 shadow-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-[#5e6a62]",children:"Total Modul"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-[#101814]",children:s})]}),e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-md bg-[#dae7e0]/50 text-[#101814]",children:e.jsx(t,{name:"grid_view",size:24})})]}),e.jsxs("div",{className:"flex flex-1 items-center justify-between rounded-xl border border-[#dae7e0] bg-white p-5 shadow-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-[#5e6a62]",children:"Total Video"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-[#101814]",children:i})]}),e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-md bg-[#fff0e6] text-[#ff8a3d]",children:e.jsx(t,{name:"play_lesson",size:24})})]}),e.jsxs("div",{className:"flex flex-1 items-center justify-between rounded-xl border border-[#dae7e0] bg-white p-5 shadow-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-[#5e6a62]",children:"Total Durasi"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-[#101814]",children:n})]}),e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-md bg-[#e6f0ff] text-[#3d8aff]",children:e.jsx(t,{name:"timer",size:24})})]})]})}function P({lesson:s}){const i=s.type==="video";return e.jsxs("div",{className:"group flex items-center justify-between border-b border-[#f1f5f9] bg-white px-6 py-4 last:border-0 hover:bg-[#f9fafb]",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"cursor-move text-[#94a3b8] opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(t,{name:"drag_indicator",size:20})}),e.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-md ${i?"bg-blue-50 text-blue-600":"bg-purple-50 text-purple-600"}`,children:e.jsx(t,{name:i?"play_circle":"quiz",size:24})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-[#1e293b]",children:s.title}),s.is_preview&&e.jsx("span",{className:"rounded bg-indigo-50 px-2 py-0.5 text-[10px] font-bold uppercase tracking-wider text-indigo-600",children:"Preview"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-[#64748b]",children:[e.jsx("span",{children:i?"Video":"Quiz"}),e.jsx("span",{className:"h-1 w-1 rounded-full bg-[#cbd5e1]"}),e.jsx("span",{children:s.durationOrQuestions}),i&&s.resourcesCount!==void 0&&s.resourcesCount>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"h-1 w-1 rounded-full bg-[#cbd5e1]"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(t,{name:"attach_file",size:12}),s.resourcesCount," File"]})]})]})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-[#d1fae5] text-[#10b981]",children:e.jsx(t,{name:"check",size:16})})})]})}function $({module:s,isExpanded:i=!1,onEdit:n,onEditQuiz:c}){const[a,x]=o.useState(i),u=s.lessons.filter(l=>l.type==="quiz"),m=u.length>0,p=l=>{l.stopPropagation();const f=s.quizIds?.[0]??u[0]?.id;f&&c&&c(f)};return e.jsxs("div",{className:"overflow-hidden rounded-xl border border-[#e2e8f0] bg-white shadow-sm transition-all hover:shadow-md",children:[e.jsxs("div",{className:`flex cursor-pointer items-center justify-between border-b px-6 py-4 transition-colors ${a?"border-[#e2e8f0] bg-[#f8fafc]":"border-transparent bg-white hover:bg-[#f8fafc]"}`,onClick:()=>x(!a),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"cursor-move text-[#94a3b8]",children:e.jsx(t,{name:"drag_indicator",size:20})}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("h3",{className:"text-base font-bold text-[#1e293b]",children:s.title})}),e.jsxs("div",{className:"mt-1 flex items-center gap-3 text-xs font-medium text-[#64748b]",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(t,{name:"videocam",size:14}),e.jsxs("span",{children:[s.stats.videos," Videos"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(t,{name:"quiz",size:14}),e.jsxs("span",{children:[s.stats.quizzes," Quiz"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(t,{name:"schedule",size:14}),e.jsx("span",{children:s.stats.duration})]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:`transition-transform duration-200 ${a?"rotate-180":""}`,children:e.jsx("button",{className:"rounded-full bg-[#f1f5f9] p-1 text-[#64748b]",children:e.jsx(t,{name:"expand_more",size:20})})})})]}),a&&e.jsxs("div",{className:"bg-[#f8fafc]",children:[e.jsx("div",{className:"border-t border-[#f1f5f9]",children:s.lessons.map(l=>e.jsx(P,{lesson:l},`${l.type}-${l.id}`))}),e.jsxs("div",{className:`grid gap-4 p-4 ${m?"grid-cols-2":"grid-cols-1"}`,children:[e.jsxs("button",{onClick:l=>{l.stopPropagation(),n?.(s.id)},className:"flex items-center justify-center gap-2 rounded-md border border-[#e2e8f0] bg-white py-3 text-sm font-bold text-[#64748b] transition-all hover:bg-[#f8fafc] hover:text-[#1e293b]",children:[e.jsx(t,{name:"edit",size:18}),"Edit Module"]}),m&&e.jsxs("button",{onClick:p,className:"flex items-center justify-center gap-2 rounded-md border border-[#e2e8f0] bg-white py-3 text-sm font-bold text-[#64748b] transition-all hover:bg-[#f8fafc] hover:text-[#1e293b]",children:[e.jsx(t,{name:"quiz",size:18}),"Edit Quiz"]})]})]})]})}function se({classData:s,stats:i,categories:n,mentors:c}){const[a,x]=o.useState(!1),[u,m]=o.useState(!1),[p,l]=o.useState(!1),[f,b]=o.useState(!1),[v,j]=o.useState(null),[N,g]=o.useState(null),z=r=>{j(r),l(!0)},w=r=>{g(r),b(!0)},y=s.modules.map(r=>{const M=r.videos.reduce((d,E)=>d+(E.duration_sec||0),0);return{id:r.id,title:r.title,status:"published",stats:{videos:r.videos.length,quizzes:r.quizzes.length,duration:h(M)},lessons:[...r.videos.map(d=>({id:d.id,title:d.title,type:"video",durationOrQuestions:h(d.duration_sec),is_preview:d.is_preview,resourcesCount:d.resources?.length||0})),...r.quizzes.map(d=>({id:d.id,title:d.title,type:"quiz",durationOrQuestions:`${d.questions_count||0} Soal`}))],quizIds:r.quizzes.map(d=>d.id)}});return e.jsxs(C,{breadcrumbs:[{label:"Kelas",href:route("admin.classes")},{label:s.title},{label:"Kurikulum"}],children:[e.jsx(k,{title:`Konten - ${s.title}`}),e.jsxs("div",{className:"space-y-8 px-4 sm:px-6 lg:px-8",children:[e.jsx(T,{classData:s,onEdit:()=>x(!0),onPublish:()=>m(!0)}),e.jsx(q,{totalModules:i.total_modules,totalLessons:i.total_videos+i.total_quizzes,totalDuration:h(i.total_duration_seconds)}),e.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-3",children:[e.jsx("div",{className:"space-y-8 lg:col-span-2",children:e.jsx(K,{modules:y,classId:s.id,onEditModule:z,onEditQuiz:w})}),e.jsx(_,{classData:s})]})]}),e.jsx(I,{isOpen:a,onClose:()=>x(!1),classData:s,categories:n,mentors:c}),e.jsx(Q,{isOpen:u,onClose:()=>m(!1),classId:s.id,classTitle:s.title}),e.jsx(S,{isOpen:p,onClose:()=>{l(!1),j(null)},moduleId:v,modules:s.modules}),e.jsx(O,{isOpen:f,onClose:()=>{b(!1),g(null)},quizId:N,modules:s.modules})]})}function T({classData:s,onEdit:i,onPublish:n}){return e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsx("span",{className:`rounded-full px-2.5 py-0.5 text-xs font-bold ${s.status==="published"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status==="published"?"Publish":"Draf"}),e.jsx("span",{className:"text-sm text-slate-500",children:s.category?.name})]}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-[#1e293b]",children:s.title}),e.jsx("p",{className:"mt-2 text-base text-[#64748b]",children:"Atur kurikulum Anda menjadi modul dan pelajaran. Seret dan lepas untuk mengatur ulang konten."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{className:"inline-flex items-center justify-center gap-2 rounded-md border border-[#e2e8f0] bg-white px-4 py-2.5 text-sm font-bold text-[#64748b] transition-all hover:bg-[#f8fafc] hover:text-[#1e293b]",onClick:i,children:[e.jsx(t,{name:"edit",size:20}),"Edit"]}),s.status==="draft"?e.jsxs("button",{onClick:n,className:"inline-flex items-center justify-center gap-2 rounded-md bg-[#059669] px-4 py-2.5 text-sm font-bold text-white shadow-lg shadow-[#059669]/20 transition-all hover:bg-[#047857]",children:[e.jsx(t,{name:"save",size:20}),"Publish Kelas"]}):e.jsxs("span",{className:"inline-flex items-center justify-center gap-2 rounded-md bg-green-100 px-4 py-2.5 text-sm font-bold text-green-800",children:[e.jsx(t,{name:"check",size:20}),"Sudah Dipublish"]})]})]})}function K({modules:s,classId:i,onEditModule:n,onEditQuiz:c}){return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"text-xs font-bold uppercase tracking-wider text-[#94a3b8]",children:"Struktur Kurikulum"})}),e.jsx("div",{className:"space-y-4",children:s.length>0?s.map((a,x)=>e.jsx($,{module:a,isExpanded:x===0,onEdit:n,onEditQuiz:c},a.id)):e.jsx("div",{className:"py-10 text-center text-slate-500",children:"Tidak ada modul ditemukan. Tambahkan modul untuk memulai."})}),e.jsxs("div",{className:"rounded-xl border-2 border-dashed border-[#e2e8f0] bg-[#f8fafc]/50 p-8 text-center transition-all hover:border-[#cbd5e1] hover:bg-[#f8fafc]",children:[e.jsx("button",{onClick:()=>window.location.href=route("admin.module.create",i),className:"inline-flex h-12 w-12 items-center justify-center rounded-full bg-[#f1f5f9] text-[#64748b] transition-transform hover:scale-110 hover:bg-[#e2e8f0] hover:text-[#1e293b]",children:e.jsx(t,{name:"add",size:24})}),e.jsx("p",{className:"mt-3 text-sm font-bold text-[#64748b]",children:"Tambah Modul Baru"})]})]})}export{se as default};
