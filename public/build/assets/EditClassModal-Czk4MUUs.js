import{r,j as t,a as F}from"./app-wjlaHdqt.js";import{C as M}from"./ClassForm-DhKhyKXJ.js";import{I as g}from"./Icon-CqVksNsp.js";import"./FormInput-CQDoE4hj.js";import"./FormSelect-CuZtCkNd.js";import"./ImageUpload-B0jmlJKd.js";import"./Avatar-BaeoEzfy.js";import"./RichTextEditor-J6tvwGnQ.js";function L({isOpen:l,onClose:d,classData:i,categories:v,mentors:y}){const[c,b]=r.useState(!1),[j,m]=r.useState({}),[n,x]=r.useState({title:"",description:"",category_id:"",price:"0",discount:"0",status:"draft"}),[f,u]=r.useState(null),[o,p]=r.useState(),[a,h]=r.useState([]);r.useEffect(()=>{l&&(x({title:i.title||"",description:i.description||"",category_id:i.category?.id?.toString()||"",price:i.price?.toString()||"0",discount:i.discount?.toString()||"0",status:i.status||"draft"}),p(i.thumbnail_url||void 0),u(null),h(i.mentors?.map(e=>({id:e.id,name:e.name,avatar:e.avatar_url}))||[]),m({}))},[l,i]),r.useEffect(()=>()=>{o&&o.startsWith("blob:")&&URL.revokeObjectURL(o)},[o]);const S=e=>{h(a.filter(s=>s.id!==e))},w=e=>{a.find(s=>s.id===e.id)||h([...a,e])},E=e=>{if(e){const s=URL.createObjectURL(e);p(s),u(e)}else p(i.thumbnail_url||void 0),u(null)},N=()=>{b(!0),m({});const e=new FormData;e.append("title",n.title),e.append("description",n.description),e.append("category_id",n.category_id),e.append("price",n.price),e.append("discount",n.discount),e.append("status",n.status),a.forEach(s=>{e.append("mentors[]",s.id.toString())}),f&&e.append("thumbnail",f),e.append("_method","PUT"),F.post(route("admin.classes.update",i.id),e,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{d()},onError:s=>{m(s)},onFinish:()=>{b(!1)}})};return l?t.jsxs("div",{className:"fixed inset-0 z-50 flex items-start justify-center overflow-y-auto",children:[t.jsx("div",{className:"fixed inset-0 bg-black/50 transition-opacity",onClick:d}),t.jsxs("div",{className:"relative z-10 my-8 w-full max-w-5xl rounded-xl bg-slate-100 p-6 shadow-xl",children:[t.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[t.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Edit Kelas"}),t.jsx("button",{onClick:d,className:"rounded-md p-2 text-slate-400 hover:bg-slate-200 hover:text-slate-600",children:t.jsx(g,{name:"close",size:24})})]}),t.jsx(M,{formData:n,onFormDataChange:x,categories:v,mentors:y,selectedMentors:a,onAddMentor:w,onRemoveMentor:S,thumbnailPreview:o,onThumbnailChange:E,errors:j}),t.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3 border-t border-slate-200 pt-6",children:[t.jsx("button",{type:"button",onClick:d,disabled:c,className:"rounded-md px-4 py-2.5 text-sm font-medium text-slate-600 transition-colors hover:bg-slate-200 disabled:opacity-50",children:"Batal"}),t.jsxs("button",{type:"button",onClick:N,disabled:c,className:"flex items-center gap-2 rounded-md bg-primary px-4 py-2.5 text-sm font-bold text-white shadow-md shadow-primary/20 transition-all hover:bg-[#00622e] disabled:opacity-50",children:[t.jsx(g,{name:"save",size:18}),c?"Menyimpan...":"Simpan Perubahan"]})]})]})]}):null}export{L as default};
